services:
  # React Web UI
  ui:
    build:
      context: ./ui
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    volumes:
      - ./ui:/app
      - /app/node_modules
    environment:
      - VITE_API_URL=http://localhost:4000
    depends_on:
      - api

  # API Gateway
  api:
    build:
      context: ./api
      dockerfile: Dockerfile
    ports:
      - "4000:4000"
    volumes:
      - ./api:/app
      - ./sdks:/app/sdks
      - /app/node_modules
      - /app/dist
    environment:
      - JAVASCRIPT_SDK_URL=http://sdk-javascript:5000
      - PYTHON_SDK_URL=http://sdk-python:5001
      - RUBY_SDK_URL=http://sdk-ruby:5004
      - PHP_SDK_URL=http://sdk-php:5005
      - GO_SDK_URL=http://sdk-go:5006
    depends_on:
      - sdk-javascript
      - sdk-python
      - sdk-ruby
      - sdk-php
      - sdk-go

  # JavaScript SDK Container (Default - Always Available)
  sdk-javascript:
    build:
      context: ./sdks/javascript
      dockerfile: Dockerfile
    ports:
      - "5000:5000"
    volumes:
      - ./sdks/javascript:/app
      - /app/node_modules
      - /app/dist

  # Python SDK Container (Default - Always Available)
  sdk-python:
    build:
      context: ./sdks/python
      dockerfile: Dockerfile
    ports:
      - "5001:5001"
    volumes:
      - ./sdks/python:/app

  # Ruby SDK Container (Tier 2 - High Priority)
  sdk-ruby:
    build:
      context: ./sdks/ruby
      dockerfile: Dockerfile
    ports:
      - "5004:5004"
    volumes:
      - ./sdks/ruby:/app

  # PHP SDK Container (Tier 2 - High Priority)
  sdk-php:
    build:
      context: ./sdks/php
      dockerfile: Dockerfile
    ports:
      - "5005:5005"
    volumes:
      - ./sdks/php:/app
      - /app/vendor

  # Go SDK Container (Tier 2 - High Priority)
  sdk-go:
    build:
      context: ./sdks/go
      dockerfile: Dockerfile
    ports:
      - "5006:5006"

networks:
  default:
    name: beforesend-network
